events {
    worker_connections 20000;
}

http {    
    upstream api {        
        server go-api1:8181;
        server go-api2:8182;
        keepalive 2;
    }

    server {        
        listen 9999;
        location / {            
            proxy_pass http://api;
            proxy_next_upstream error timeout http_500;                                                
            proxy_http_version 1.1;            
            proxy_set_header   "Connection" "";
            proxy_set_header Proxy-Connection "keep-alive";
        }
    }
}